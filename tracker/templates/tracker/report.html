<!DOCTYPE html>
<html>
<head>
    <title>QR Analytics</title>
    <style>
        body{font-family:Arial;margin:30px;background:#f4f6f8}
        .card{background:white;padding:20px;margin:15px 0;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,.1)}
        table{width:100%;border-collapse:collapse}
        th,td{padding:8px;border-bottom:1px solid #ddd;text-align:left}
        th{background:#2c3e50;color:white}
        h1{color:#2c3e50}
        .stats{display:flex;gap:20px}
        .box{flex:1;padding:20px;background:#3498db;color:white;border-radius:8px;text-align:center;font-size:20px}
    </style>
</head>
<body>

<h1>{{ link.name }} Analytics</h1>

<div class="stats">
    <div class="box">Total Clicks<br><b>{{ total_clicks }}</b></div>
    <div class="box">Unique Visitors<br><b>{{ unique_visitors }}</b></div>
    <div class="box">Today Clicks<br><b>{{ today_clicks }}</b></div>
</div>

<div class="card">
<h2>Device Distribution</h2>
<table>
<tr><th>Device</th><th>Clicks</th></tr>
{% for d in device_stats %}
<tr><td>{{ d.device }}</td><td>{{ d.total }}</td></tr>
{% endfor %}
</table>
</div>

<div class="card">
<h2>Browser Distribution</h2>
<table>
<tr><th>Browser</th><th>Clicks</th></tr>
{% for b in browser_stats %}
<tr><td>{{ b.browser }}</td><td>{{ b.total }}</td></tr>
{% endfor %}
</table>
</div>

<div class="card">
<h2>Last 7 Days Activity</h2>
<table>
<tr><th>Date</th><th>Clicks</th></tr>
{% for day,count in last7 %}
<tr><td>{{ day }}</td><td>{{ count }}</td></tr>
{% endfor %}
</table>
</div>

<div class="card">
<h2>Recent Visitors</h2>
<table>
<tr>
<th>Time</th><th>IP</th><th>Device</th><th>Browser</th><th>OS</th>
</tr>
{% for c in clicks %}
<tr>
<td>{{ c.clicked_at }}</td>
<td>{{ c.ip_address }}</td>
<td>{{ c.device }}</td>
<td>{{ c.browser }}</td>
<td>{{ c.os }}</td>
</tr>
{% endfor %}
</table>
</div>

</body>
</html>
